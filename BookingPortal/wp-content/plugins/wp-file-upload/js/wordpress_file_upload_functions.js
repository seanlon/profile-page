function wfu_Initialize_Consts(e){if("undefined"==typeof GlobalData.consts){GlobalData.consts=new Object;for(var a=e.split(";"),s=0;s<a.length;s++)const_txt=a[s].split(":"),GlobalData.consts[wfu_plugin_decode_string(const_txt[0])]=wfu_plugin_decode_string(const_txt[1])}}function wfu_plugin_load_action(e){wfu_install_unload_hook();var a=document.getElementById("selectsubdiredit_"+e);a&&"none"!=a.style.display&&wfu_attach_element_handlers(a,new Function("wfu_selectsubdiredit_change("+e+");"))}function wfu_install_unload_hook(){window.onbeforeunload=wfu_unload_hook}function wfu_unload_hook(){return""!=GlobalData.UploadInProgressString&&""!=GlobalData.UploadInProgressString.trim()?GlobalData.consts.wfu_pageexit_prompt:void 0}function wfu_Check_Browser_Capabilities(){if("undefined"==typeof wfu_BrowserCaps){wfu_BrowserCaps=new Object;var e=wfu_GetHttpRequestObject();wfu_BrowserCaps.supportsAJAX=null!=e,wfu_BrowserCaps.supportsUploadProgress=!!(e&&"upload"in e&&"onprogress"in e.upload);var a=null;try{var a=new FormData}catch(s){}wfu_BrowserCaps.supportsHTML5=null!=a;var s=document.createElement("iframe");wfu_BrowserCaps.supportsIFRAME=null!=s,wfu_BrowserCaps.supportsDRAGDROP=window.FileReader?!0:!1,wfu_BrowserCaps.supportsAnimation=wfu_check_animation(),wfu_BrowserCaps.isSafari=Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0}}function wfu_check_animation(){var e=!1,a="animation",s="",t="Webkit Moz O ms Khtml".split(" "),n="",l=document.createElement("DIV");if(l.style.animationName&&(e=!0),e===!1)for(var r=0;r<t.length;r++)if(void 0!==l.style[t[r]+"AnimationName"]){n=t[r],a=n+"Animation",s="-"+n.toLowerCase()+"-",e=!0;break}return e}function wfu_join_strings(e){for(var a=[].slice.call(arguments),s="",t="",n=1;n<a.length;n++)t=""==s||""==a[n]?"":e,s+=t+a[n];return s}function wfu_plugin_decode_string(e){for(var a,s,t=0,n="";t<e.length;)a=parseInt(e.substr(t,2),16),s=128>a?a:224>a?((31&a)<<6)+(63&parseInt(e.substr(t+=2,2),16)):((15&a)<<12)+((63&parseInt(e.substr(t+=2,2),16))<<6)+(63&parseInt(e.substr(t+=2,2),16)),n+=String.fromCharCode(s),t+=2;return n}function wfu_plugin_encode_string(e){var a=0,s="",t="";for(a=0;a<e.length;a++)num=e.charCodeAt(a),num>=2048?num=((16773120&num|917504)<<4)+((4032&num|8192)<<2)+(63&num|128):num>=128&&(num=((65472&num|12288)<<2)+(63&num|128)),t=num.toString(16),(1==t.length||3==t.length||5==t.length)&&(t="0"+t),s+=t;return s}function wfu_randomString(e){for(var a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",s=e,t="",n=0;s>n;n++){var l=Math.floor(Math.random()*a.length);t+=a.substring(l,l+1)}return t}function wfu_addEventHandler(e,a,s){e.addEventListener?e.addEventListener(a,s,!1):e.attachEvent?e.attachEvent("on"+a,s):e["on"+a]=s}function wfu_attach_element_handlers(e,a){for(var s=["DOMAttrModified","textInput","input","change","keypress","paste","focus","propertychange"],t=0;t<s.length;t++)wfu_addEventHandler(e,s[t],a)}function wfu_GetHttpRequestObject(){var e=null;try{e=new XMLHttpRequest}catch(a){try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(s){try{e=new ActiveXObject("Microsoft.XMLHTTP")}catch(a){}}}if(null==e&&window.createRequest)try{xmlhttp=window.createRequest()}catch(a){}return e}function wfu_filedetails_showhide(e,a,s){var t=(document.getElementById("wfu_messageblock_arrow_"+e+"_"+a),document.getElementById("wfu_messageblock_arrow_"+e+"_up_"+a)),n=document.getElementById("wfu_messageblock_arrow_"+e+"_down_"+a),l=document.getElementById("wfu_messageblock_subheader_"+e+"_"+a),r=document.getElementById("wfu_messageblock_header_"+e+"_state_"+a);s?(t.style.display="",n.style.display="none",l.style.display="",r.value=""):(t.style.display="none",n.style.display="",l.style.display="none",r.value="none")}function wfu_get_file_ids(e){for(var a=(document.getElementById("wfu_messageblock_"+e),document.getElementById("wfu_messageblock_subheader_"+e).nextSibling),s="wfu_messageblock_"+e+"_",t=[];null!=a;)1===a.nodeType&&a.id.substr(0,s.length)==s&&t.push(a.id.substr(a.id.lastIndexOf("_")+1)),a=a.nextSibling;return t}function wfu_get_filelist(e,a){a="undefined"!=typeof a?a:!0;var s=document.getElementById("upfile_"+e),t=s.files;return t||(t=s.value?[{name:s.value}]:[]),a&&"undefined"!=typeof s.filearray&&(t=s.filearray),t}function wfu_filedetails_toggle(e,a){var s=(document.getElementById("wfu_messageblock_arrow_"+e+"_"+a),document.getElementById("wfu_messageblock_arrow_"+e+"_up_"+a));wfu_filedetails_showhide(e,a,"none"==s.style.display)}function wfu_headerdetails_showhide(e,a){var s=(document.getElementById("wfu_messageblock_arrow_"+e),document.getElementById("wfu_messageblock_arrow_"+e+"_up")),t=document.getElementById("wfu_messageblock_arrow_"+e+"_down"),n=document.getElementById("wfu_messageblock_subheader_"+e),l=document.getElementById("wfu_messageblock_subheader_"+e+"_message"),r=document.getElementById("wfu_messageblock_subheader_"+e+"_adminmessage"),i=document.getElementById("wfu_messageblock_header_"+e+"_state"),o=wfu_get_file_ids(e);if(a){s.style.display="",t.style.display="none",("none"!=l.style.display||"none"!=r.style.display)&&(n.style.display=""),i.value="";for(var _=0;_<o.length;_++)document.getElementById("wfu_messageblock_"+e+"_"+o[_]).style.display="",document.getElementById("wfu_messageblock_subheader_"+e+"_"+o[_]).style.display=document.getElementById("wfu_messageblock_header_"+e+"_state_"+o[_]).value}else{s.style.display="none",t.style.display="",n.style.display="none",i.value="none";for(var _=0;_<o.length;_++)document.getElementById("wfu_messageblock_"+e+"_"+o[_]).style.display="none",document.getElementById("wfu_messageblock_subheader_"+e+"_"+o[_]).style.display="none"}}function wfu_headerdetails_toggle(e){var a=(document.getElementById("wfu_messageblock_arrow_"+e),document.getElementById("wfu_messageblock_arrow_"+e+"_up"));wfu_headerdetails_showhide(e,"none"==a.style.display)}function wfu_selectbutton_changed(e,a){wfu_BrowserCaps.supportsAJAX&&wfu_BrowserCaps.supportsHTML5||(a=0);var s=document.getElementById("upfile_"+e),t=wfu_get_filelist(e,!1);if(1==a){"undefined"==typeof s.filearray&&(s.filearray=Array());for(var n=0;n<t.length;n++)s.filearray.push(t[n])}else"undefined"!=typeof s.filearray&&delete s.filearray;wfu_update_filename_text(e)}function wfu_selectbutton_clicked(e){var a=document.getElementById("wordpress_file_upload_message_"+e);a&&(a.style.display="none"),wfu_reset_message(e),document.getElementById("upfile_"+e).value="";var s=document.getElementById("fileName_"+e);s&&(s.value="",s.className="file_input_textbox")}function wfu_update_uploadbutton_status(e){var a=document.getElementById("upload_"+e);if(a){var s=wfu_get_filelist(e),t=s.length>0;a.disabled=!t}}function wfu_update_filename_text(e){var a=document.getElementById("fileName_"+e);if(a){for(var s=wfu_get_filelist(e),t="",n=0;n<s.length;n++)""!=t&&(t+=", "),t+=s[n].name.replace(/c:\\fakepath\\/i,"");a.value=t}}function wfu_selectsubdir_check(e){var a=document.getElementById("selectsubdir_"+e);if(!a)return!0;var s=document.getElementById("selectsubdiredit_"+e),t="none"!=s.style.display;return t&&a.selectedIndex>0&&(s.value=a.value.replace(/^\s+/,""),s.className="file_item_clean_match subfolder_autoplus_match",wfu_selectsubdiredit_change(e)),t?document.getElementById("hiddeninput_"+e).value=s.value:document.getElementById("hiddeninput_"+e).value=a.selectedIndex,!t&&0==a.selectedIndex||t&&(""==s.value||"file_item_clean_empty subfolder_autoplus_empty"==s.className)?(t?(a.className="subfolder_autoplus_dropdown_prompt",s.value="",GlobalData.FreeChangeHandler=!0,s.className="file_item_clean_prompt subfolder_autoplus_prompt",GlobalData.FreeChangeHandler=!1):a.className="file_item_clean_prompt subfolder_dropdown_prompt",!1):(t?a.className="subfolder_autoplus_dropdown":a.className="file_item_clean subfolder_dropdown",t&&"file_item_clean_prompt subfolder_autoplus_prompt"==s.className&&(s.className="file_item_clean subfolder_autoplus"),a.options[0].style.display="none",!0)}function wfu_selectsubdiredit_enter(e){var a=document.getElementById("selectsubdir_"+e),s=document.getElementById("selectsubdiredit_"+e);"file_item_clean_empty subfolder_autoplus_empty"==s.className&&(s.value=""),a.className="subfolder_autoplus_dropdown",s.className="file_item_clean subfolder_autoplus"}function wfu_selectsubdiredit_exit(e){var a=document.getElementById("selectsubdiredit_"+e);""==a.value&&(a.value=GlobalData.consts.wfu_subdir_typedir,a.className="file_item_clean_empty subfolder_autoplus_empty")}function wfu_selectsubdiredit_change(e){if(!GlobalData.FreeChangeHandler){var a=document.getElementById("selectsubdir_"+e),s=document.getElementById("selectsubdiredit_"+e);if("none"!=s.style.display){if("file_item_clean_empty subfolder_autoplus_empty"==s.className)return a.selectedIndex=0,void(document.getElementById("hiddeninput_"+e).value="");document.getElementById("hiddeninput_"+e).value=s.value;for(var t,n=!1,l=1;l<a.options.length;l++)t=a.options[l].value.replace(/^\s+/,"").toLowerCase(),s.value.length>=3?t.substr(0,s.value.length)==s.value.toLowerCase()?a.options[l].style.display="block":a.options[l].style.display="none":a.options[l].style.display="block",a.options[l].value.replace(/^\s+/,"")==s.value&&(a.selectedIndex=l,s.className="file_item_clean_match subfolder_autoplus_match",n=!0);n||(a.selectedIndex=0,s.className="file_item_clean subfolder_autoplus")}}}function wfu_selectsubdir_disable_onoff(e,a){var s=document.getElementById("selectsubdir_"+e);if(!s)return!0;var t=document.getElementById("selectsubdiredit_"+e),n="none"!=t.style.display;s.disabled=a,n&&(t.disabled=a)}function wfu_userdata_focused(e){var a=document.getElementById(e.id.replace("_field_","_fieldwrapper_"));if("file_userdata_fieldwrapper_required_empty"==a.className){a.className="file_userdata_fieldwrapper_required";var s=document.getElementById(e.id.replace("_field_","_hint_"));s.style.display="none"}}function wfu_Redirect(e){window.location=e}function wfu_loadStart(e){}function wfu_uploadProgress(e,a,s,t){t&&"undefined"==typeof this.xhr&&(console.log("total="+e.total+", loaded="+e.loaded),console.log(e));var n=GlobalData[a].xhrs[s],l=0,r=0,i=document.getElementById("progressbar_"+a+"_animation");if(e.lengthComputable){if(n.sizeloaded=e.loaded,n.size<e.total&&e.total>0){r=e.total-n.size,n.deltasize+=r,n.size+=r;for(var o=0;o<GlobalData[a].xhrs.length;o++)GlobalData[a].xhrs[o].file_id==n.file_id&&(GlobalData[a].xhrs[o].totalsize+=r)}if(i){for(var _=0,d=0,u=[],o=0;o<GlobalData[a].xhrs.length;o++)u[GlobalData[a].xhrs[o].file_id]=0;for(var o=0;o<GlobalData[a].xhrs.length;o++)u[GlobalData[a].xhrs[o].file_id]=Math.max(GlobalData[a].xhrs[o].totalsize,u[GlobalData[a].xhrs[o].file_id]);for(var o=0;o<u.length;o++)"undefined"!=typeof u[o]&&(_+=u[o]);for(var o=0;o<GlobalData[a].xhrs.length;o++)d+=GlobalData[a].xhrs[o].sizeloaded;l=Math.round(100*d/_),i.style.width=l.toString()+"%"}}else i&&(i.style.width="0%")}function wfu_notify_WPFilebase(e,a){var s=wfu_GetHttpRequestObject();if(null==s){var t=document.createElement("iframe");return t.style.display="none",t.src=GlobalData.consts.ajax_url+"?action=wfu_ajax_action_notify_wpfilebase&params_index="+e+"&session_token="+a,void document.body.appendChild(t)}var n=GlobalData.consts.ajax_url;params=new Array(3),params[0]=new Array(2),params[0][0]="action",params[0][1]="wfu_ajax_action_notify_wpfilebase",params[1]=new Array(2),params[1][0]="params_index",params[1][1]=e,params[2]=new Array(2),params[2][0]="session_token",params[2][1]=a;for(var l="",t=0;t<params.length;t++)l+=(t>0?"&":"")+params[t][0]+"="+encodeURI(params[t][1]);s.open("POST",n,!0),s.setRequestHeader("Content-type","application/x-www-form-urlencoded"),s.onreadystatechange=function(){},s.send(l)}function wfu_send_email_notification(e,a,s,t,n,l,r,i,o){var _=wfu_GetHttpRequestObject();if(null!=_){var d=GlobalData.consts.ajax_url,u=wfu_get_userdata_count(e);params=new Array(7+u),params[0]=new Array(2),params[0][0]="action",params[0][1]="wfu_ajax_action_send_email_notification",params[1]=new Array(2),params[1][0]="params_index",params[1][1]=s,params[2]=new Array(2),params[2][0]="session_token",params[2][1]=t,params[3]=new Array(2),params[3][0]="only_filename_list",params[3][1]=n,params[4]=new Array(2),params[4][0]="target_path_list",params[4][1]=l,params[5]=new Array(2),params[5][0]="attachment_list",params[5][1]=r,params[6]=new Array(2),params[6][0]="uniqueuploadid_"+e,params[6][1]=a;for(var m=0;u>m;m++)params[7+m]=new Array(2),params[7+m][0]="userdata_"+m,params[7+m][1]=wfu_plugin_encode_string(document.getElementById("hiddeninput_"+e+"_userdata_"+m).value);for(var c="",m=0;m<params.length;m++)c+=(m>0?"&":"")+params[m][0]+"="+encodeURI(params[m][1]);var f=new Date;_.xhrid=-1,_.shortcode_id=e,_.requesttype="email",_.file_id=0,_.loading=!1,_.aborted=!1,_.unique_id=a,_.debugmode=i,_.is_admin=o,_.params_index=s,_.session_token=t,_.start_time=f.getTime(),_.end_time=_.start_time,_.finish_time=_.start_time+1e3*parseInt(GlobalData.consts.max_time_limit),_.fail_colors=GlobalData.consts.fail_colors,_.error_message_header="",_.error_message_failed=GlobalData.consts.message_failed,_.error_message_cancelled=GlobalData.consts.message_cancelled,_.error_adminmessage_unknown="",_.open("POST",d,!0),_.setRequestHeader("Content-type","application/x-www-form-urlencoded"),_.addEventListener("load",wfu_uploadComplete,!1),_.addEventListener("error",wfu_uploadFailed,!1),_.addEventListener("abort",wfu_uploadCanceled,!1),_.send(c)}}function wfu_format_debug_data(e,a){return output='<label class="file_messageblock_subheader_debugmessage_label">',output+="Debug Data"+a,output+="</label>",output+='<div class="file_messageblock_subheader_debugmessage_container">',output+=e,output+="</div>",output}function wfu_uploadComplete(e){var a=new Date,s=this.shortcode_id,t=(this.file_id,!1),n="",l="",r="",i="unknown",o="",_="",d="wfu_fileupload_success:";this.loading=!1,this.end_time=a.getTime();var u=e.target.responseText,m=u,c="error";if(-1!=u&&u.indexOf("force_errorabort_code")>-1&&(c="errorabort",u=u.replace("force_errorabort_code","")),-1!=u){var f=u.indexOf(d);if(f>-1&&("true"==this.debugmode&&(_=u.substr(0,f)),m=u.substr(f+d.length),f=m.indexOf(":"),n=m.substr(0,f),m=m.substr(f+1),f=m.indexOf(":"),r=m.substr(0,f),l=m.substr(f+1)),""!=_){var p="";"fileupload"==this.requesttype?p=" - File: "+this.file_id:"email"==this.requesttype&&(p=" - Email Notification"),_=wfu_format_debug_data(_,p)}if(""!=r){var g=r.split(";");if(1==parseInt(g[2])){var y=g[3].split(",");i=wfu_plugin_decode_string(y[0]),o=y[4]}}}if(""==l||""==r){var b=this.fail_colors.split(","),w=wfu_Initialize_Params();w.general.shortcode_id=s,w.general.unique_id=this.unique_id,w.general.state=7,w.general.files_count="fileupload"==this.requesttype?1:0,w.general.upload_finish_time=this.finish_time,w.general.fail_message=GlobalData.consts.message_unknown,w.general.fail_admin_message=wfu_join_strings("<br />",this.error_adminmessage_unknown,this.requesttype+":"+m),w.general.files_count>0?(w[0]={},w[0].color=b[0],w[0].bgcolor=b[1],w[0].borcolor=b[2],w[0].message_type=c,i=c,w[0].header=this.error_message_header,w[0].message=GlobalData.consts.message_timelimit,w[0].admin_messages="true"==this.is_admin?GlobalData.consts.message_admin_timelimit:""):w.general.admin_messages.other="true"==this.is_admin?GlobalData.consts.message_admin_timelimit:"",w.general.upload_finish_time>0&&a.getTime()<w.general.upload_finish_time&&(w.general.files_count>0?(w[0].message=w.general.fail_message,w[0].admin_messages="true"==this.is_admin?w.general.fail_admin_message:""):w.general.admin_messages.other="true"==this.is_admin?w.general.fail_admin_message:"")}return t=""==l||""==r?wfu_ProcessUploadComplete(s,this.file_id,w,this.unique_id,this.params_index,this.session_token,"",[this.debugmode,_,this.is_admin],this.requesttype,""):wfu_ProcessUploadComplete(s,this.file_id,l,this.unique_id,this.params_index,this.session_token,r,[this.debugmode,_,this.is_admin],this.requesttype,n),t&&(wfu_unlock_upload(e.target.shortcode_id),wfu_hide_simple_progressbar(s),wfu_clear(e.target.shortcode_id)),e.target.return_status?i:void 0}function wfu_ProcessUploadComplete(sid,file_id,upload_params,unique_id,params_index,session_token,safe_output,debug_data,request_type,js_script_enc){if(sid&&!(0>sid)&&null!=upload_params&&""!=upload_params&&""!=unique_id&&("no-ajax"==unique_id||GlobalData[sid])){var do_redirect=!1;if("string"==typeof upload_params){upload_params=wfu_plugin_decode_string(upload_params.replace(/^\s+|\s+$/g,""));var Params=null;try{Params=JSON.parse(upload_params)}catch(e){}if(null==Params){var safe_parts=safe_output.split(";");Params=wfu_Initialize_Params(),Params.general.shortcode_id=sid,Params.general.unique_id=unique_id,Params.general.state=safe_parts[0],4==Params.general.state&&Params.general.state++;var default_colors=safe_parts[1].split(","),filedata="",error_jsonparse_filemessage=GlobalData.consts.jsonparse_filemessage,error_jsonparse_message=GlobalData.consts.jsonparse_message,error_jsonparse_adminmessage=GlobalData.consts.jsonparse_adminmessage;Params.general.files_count=parseInt(safe_parts[2]);for(var i=0;i<Params.general.files_count;i++)Params[i]={},Params[i].color=default_colors[0],Params[i].bgcolor=default_colors[1],Params[i].borcolor=default_colors[2],filedata=safe_parts[i+3].split(","),Params[i].message_type=wfu_plugin_decode_string(filedata[0]),Params[i].header=wfu_plugin_decode_string(filedata[1]),"success"==Params[i].message_type&&(Params[i].header+=error_jsonparse_filemessage,Params[i].message_type="warning"),Params[i].message=wfu_join_strings("<br />",error_jsonparse_message,wfu_plugin_decode_string(filedata[2])),Params[i].admin_messages=wfu_join_strings("<br />",error_jsonparse_adminmessage,wfu_plugin_decode_string(filedata[3]))}}else{if("object"!=typeof upload_params)return;var Params=upload_params}for(i=0;Params[i];)Params[i].message_type&&"error"==Params[i].message_type.substr(0,5)&&(Params[i].message_type=Params[i].message_type.substr(0,5)),i++;var message_table=document.getElementById("wfu_messageblock_"+sid),UploadStates_Ok=!0;if(!UploadStates[sid]&&message_table){var upload_states=document.getElementById("wfu_messageblock_header_"+sid+"_states").value;upload_states=wfu_plugin_decode_string(upload_states.replace(/^\s+|\s+$/g,"")),UploadStates[sid]=null;try{UploadStates[sid]=JSON.parse(upload_states)}catch(e){}null==UploadStates[sid]&&(UploadStates_Ok=!1)}GlobalData[sid]||(GlobalData[sid]=Object());var G=GlobalData[sid];if("no-ajax"==unique_id)G.last=!1,G.unique_id="",G.files_count=Params.general.files_count,0==Params.general.state&&(Params.general.files_count=0),G.files_processed=Params.general.files_count,UploadStates_Ok?G.upload_state=Params.general.state:G.upload_state=10,G.message=Params.general.message,G.update_wpfilebase=Params.general.update_wpfilebase,G.redirect_link=Params.general.redirect_link,G.notify_only_filename_list="",G.notify_target_path_list="",G.notify_attachment_list="",G.admin_messages={},G.admin_messages.wpfilebase=Params.general.admin_messages.wpfilebase,G.admin_messages.notify=Params.general.admin_messages.notify,G.admin_messages.redirect=Params.general.admin_messages.redirect,G.admin_messages.debug=debug_data[1],G.admin_messages.other=Params.general.admin_messages.other,G.errors={},G.errors.wpfilebase=Params.general.errors.wpfilebase,G.errors.notify=Params.general.errors.notify,G.errors.redirect=Params.general.errors.redirect,G.current_size=0,G.total_size=0;else{if(""==G.unique_id||G.unique_id!=unique_id||G.unique_id!=Params.general.unique_id)return;if(G.last)return;0==Params.general.files_count&&Params[0]&&"error"==Params[0].message_type&&(Params.general.files_count=1);for(var file_status="",i=0;i<Params.general.files_count;i++)file_status="error"==Params[i].message_type&&0==G.files_processed?"error1":"error"==Params[i].message_type&&G.files_processed>0?"error2":Params[i].message_type,G.upload_state=GlobalData.filestatematch[file_status][G.upload_state];UploadStates_Ok||(G.upload_state=10),G.files_processed+=Params.general.files_count,G.message=wfu_join_strings("<br />",G.message,Params.general.message),""==G.update_wpfilebase&&(G.update_wpfilebase=Params.general.update_wpfilebase),(!request_type||request_type&&"email"!=request_type)&&(G.redirect_link=Params.general.redirect_link),G.notify_only_filename_list=wfu_join_strings(", ",G.notify_only_filename_list,Params.general.notify_only_filename_list),G.notify_target_path_list=wfu_join_strings(", ",G.notify_target_path_list,Params.general.notify_target_path_list),G.notify_attachment_list=wfu_join_strings(",",G.notify_attachment_list,Params.general.notify_attachment_list),G.admin_messages.debug=wfu_join_strings("<br />",G.admin_messages.debug,debug_data[1]),G.admin_messages.other=wfu_join_strings("<br />",G.admin_messages.other,Params.general.admin_messages.other),""==G.admin_messages.wpfilebase&&(G.admin_messages.wpfilebase=Params.general.admin_messages.wpfilebase),""==G.admin_messages.notify&&(G.admin_messages.notify=Params.general.admin_messages.notify),""==G.admin_messages.redirect&&(G.admin_messages.redirect=Params.general.admin_messages.redirect),""==G.errors.wpfilebase&&(G.errors.wpfilebase=Params.general.errors.wpfilebase),""==G.errors.notify&&(G.errors.notify=Params.general.errors.notify),""==G.errors.redirect&&(G.errors.redirect=Params.general.errors.redirect)}G.files_processed==G.files_count&&(G.last=!0,""!=G.update_wpfilebase&&(G.admin_messages.wpfilebase="",wfu_notify_WPFilebase(params_index,session_token)),""!=G.notify_only_filename_list&&(G.admin_messages.notify="",wfu_send_email_notification(sid,unique_id,params_index,session_token,G.notify_only_filename_list,G.notify_target_path_list,G.notify_attachment_list,debug_data[0],debug_data[2]),G.last=!1,G.notify_only_filename_list=""),G.last&&("no-ajax"!=unique_id&&wfu_notify_server_upload_ended(sid,unique_id,params_index,session_token),GlobalData.UploadInProgressString=GlobalData.UploadInProgressString.replace(new RegExp("\\["+unique_id+"\\]","g"),"")),""!=G.errors.redirect&&(G.redirect_link=""),""!=G.redirect_link&&G.last&&""==GlobalData.UploadInProgressString.trim()&&(G.upload_state=11,do_redirect=!0));var nonadmin_message=G.message,admin_message=wfu_join_strings("<br />",G.admin_messages.other,G.admin_messages.wpfilebase,G.admin_messages.notify,G.admin_messages.redirect,G.admin_messages.debug);if(!UploadStates_Ok){var error_jsonparse_headermessage=GlobalData.consts.jsonparse_headermessage,error_jsonparse_headeradminmessage=GlobalData.consts.jsonparse_headeradminmessage;nonadmin_message=wfu_join_strings("<br />",error_jsonparse_headermessage,nonadmin_message),admin_message=wfu_join_strings("<br />",error_jsonparse_headeradminmessage,admin_message)}if(G.last){0==G.files_count?G.upload_state=8:G.upload_state<4&&(G.upload_state+=4);var admin_messages_exist=""!=G.admin_messages.wpfilebase||""!=G.admin_messages.notify||""!=G.admin_messages.redirect||""!=G.admin_messages.other;4==G.upload_state&&""!=admin_message?G.upload_state++:5==G.upload_state&&""==!admin_message&&""==nonadmin_message&&G.upload_state--}if(message_table){var subheader_state=document.getElementById("wfu_messageblock_header_"+sid+"_state"),single_file_shown=1==G.files_count&&""==nonadmin_message&&""==admin_message&&G.last&&!do_redirect;if(single_file_shown)document.getElementById("wfu_messageblock_header_"+sid).style.display="none";else{document.getElementById("wfu_messageblock_header_"+sid).style.display="";var header_container=document.getElementById("wfu_messageblock_header_"+sid+"_container");if(UploadStates_Ok){var suffix="";1!=G.files_count||5!=G.upload_state&&7!=G.upload_state||(suffix="_singlefile"),header_container.innerHTML=UploadStates[sid]["State"+G.upload_state+suffix]}else{header_container.innerHTML="";var safe_container=document.getElementById("wfu_messageblock_header_"+sid+"_safecontainer");header_container.innerHTML=safe_container.innerHTML.replace(/_safe/g,"")}var subheader_show=!1;""!=nonadmin_message?(document.getElementById("wfu_messageblock_subheader_"+sid+"_message").style.display="",document.getElementById("wfu_messageblock_subheader_"+sid+"_messagelabel").innerHTML=nonadmin_message,subheader_show=!0):document.getElementById("wfu_messageblock_subheader_"+sid+"_message").style.display="none",""!=admin_message?(document.getElementById("wfu_messageblock_subheader_"+sid+"_adminmessage").style.display="",document.getElementById("wfu_messageblock_subheader_"+sid+"_adminmessagelabel").innerHTML=admin_message,subheader_show=!0):document.getElementById("wfu_messageblock_subheader_"+sid+"_adminmessage").style.display="none",subheader_show?document.getElementById("wfu_messageblock_subheader_"+sid).style.display=subheader_state.value:document.getElementById("wfu_messageblock_subheader_"+sid).style.display="none",subheader_show||G.files_processed>0?(header_container.colSpan=2,document.getElementById("wfu_messageblock_arrow_"+sid).style.display=""):(document.getElementById("wfu_messageblock_arrow_"+sid).style.display="none",header_container.colSpan=3)}for(var next_block=document.getElementById("wfu_messageblock_subheader_"+sid),next_block_id=0,file_block=null,file_template_container=document.getElementById("wfu_messageblock_"+sid+"_filetemplate"),file_contents="",door=document.getElementById("wfu_messageblock_"+sid+"_door"),ii=0,headerspan=1,subheaderspan=2,file_template=wfu_plugin_decode_string(file_template_container.value.replace(/^\s+|\s+$/g,"")),i=0;i<Params.general.files_count;i++){for(ii=i+file_id,file_contents=file_template.replace(/\[file_id\]/g,ii),file_contents=file_contents.replace(/\[filenumber_display\]/g,""),file_contents=file_contents.replace(/\[fileheader_color\]/g,Params[i].color),file_contents=file_contents.replace(/\[fileheader_bgcolor\]/g,Params[i].bgcolor),file_contents=file_contents.replace(/\[fileheader_borcolor\]/g,Params[i].borcolor),file_contents=file_contents.replace(/\[fileheader_message\]/g,Params[i].header),file_contents=file_contents.replace(/\[filesubheadermessage_display\]/g,'style="display:none;"'),file_contents=file_contents.replace(/\[filesubheader_message\]/g,Params[i].message),file_contents=file_contents.replace(/\[filesubheaderadminmessage_display\]/g,'style="display:none;"'),file_contents=file_contents.replace(/\[filesubheader_adminmessage\]/g,Params[i].admin_messages),file_contents="<table><tbody>"+file_contents+"</tbody></table>",door.innerHTML=file_contents,headerspan=1,subheaderspan=2,subheader_show=!1,file_block=document.getElementById("wfu_messageblock_"+sid+"_"+ii),1==G.files_count?(document.getElementById("wfu_messageblock_"+sid+"_filenumber_"+ii).style.display="none",document.getElementById("wfu_messageblock_subheader_"+sid+"_fileempty_"+ii).style.display="none",single_file_shown?file_block.style.display="":file_block.style.display=subheader_state.value,headerspan++,subheaderspan++):file_block.style.display=subheader_state.value,""!=Params[i].message&&(document.getElementById("wfu_messageblock_subheader_"+sid+"_message_"+ii).style.display="",subheader_show=!0),""!=Params[i].admin_messages&&(document.getElementById("wfu_messageblock_subheader_"+sid+"_adminmessage_"+ii).style.display="",subheader_show=!0),subheader_show||(document.getElementById("wfu_messageblock_arrow_"+sid+"_"+ii).style.display="none",headerspan++),document.getElementById("wfu_messageblock_header_"+sid+"_container_"+ii).colSpan=headerspan,document.getElementById("wfu_messageblock_subheader_"+sid+"_container_"+ii).colSpan=subheaderspan;ii>next_block_id&&(next_block=next_block.nextSibling,null!=next_block);)1===next_block.nodeType&&(next_block_id=next_block.id.substr(next_block.id.lastIndexOf("_")+1));message_table.tBodies[0].insertBefore(file_block,next_block),next_block=file_block.nextSibling,file_block=document.getElementById("wfu_messageblock_subheader_"+sid+"_"+ii),message_table.tBodies[0].insertBefore(file_block,next_block),next_block=file_block,next_block_id=ii}single_file_shown&&(document.getElementById("wfu_messageblock_"+sid+"_1").style.display=""),message_table.style.display="",document.getElementById("wordpress_file_upload_message_"+sid).style.display=""}return js_script_enc&&eval(wfu_plugin_decode_string(js_script_enc)),do_redirect&&wfu_Redirect(G.redirect_link),G.last}}function wfu_uploadFailed(e,a){a&&(console.log("failure report following"),console.log(e));var s=e.target,t={target:{responseText:"",shortcode_id:s.shortcode_id}};wfu_uploadComplete.call(s,t)}function wfu_uploadCanceled(e){}function wfu_notify_server_upload_ended(e,a,s,t){var n=wfu_GetHttpRequestObject();if(null!=n){var l=GlobalData.consts.ajax_url;params=new Array(5),params[0]=new Array(2),params[0][0]="action",params[0][1]="wfu_ajax_action",params[1]=new Array(2),params[1][0]="uniqueuploadid_"+e,params[1][1]=a,params[2]=new Array(2),params[2][0]="params_index",params[2][1]=s,params[3]=new Array(2),params[3][0]="session_token",params[3][1]=t,params[4]=new Array(2),params[4][0]="upload_finished",params[4][1]=1;for(var r="",i=0;i<params.length;i++)r+=(i>0?"&":"")+params[i][0]+"="+encodeURI(params[i][1]);n.open("POST",l,!0),n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.onreadystatechange=function(){4==n.readyState&&200==n.status},n.send(r)}}function wfu_Initialize_Params(){var e={};return e.version="full",e.general={},e.general.shortcode_id=0,e.general.unique_id="",e.general.state=0,e.general.files_count=0,e.general.update_wpfilebase="",e.general.redirect_link="",e.general.upload_finish_time=0,e.general.message="",e.general.message_type="",e.general.admin_messages={},e.general.admin_messages.wpfilebase="",e.general.admin_messages.notify="",e.general.admin_messages.redirect="",e.general.admin_messages.other="",e.general.errors={},e.general.errors.wpfilebase="",e.general.errors.notify="",e.general.errors.redirect="",e.general.color="",e.general.bgcolor="",e.general.borcolor="",e.general.notify_only_filename_list="",e.general.notify_target_path_list="",e.general.notify_attachment_list="",e.general.fail_message="",e.general.fail_admin_message="",e}function wfu_redirect_to_classic(e,a,s,t){0!=wfu_filesselected(e)&&wfu_selectsubdir_check(e)&&wfu_check_required_userdata(e,!0)&&wfu_redirect_to_classic_cont(e,a,s,t,[""])}function wfu_redirect_to_classic_cont(e,a,s,t,n){var l=function(n){if(n.indexOf("wfu_response_success:")>-1){var l=wfu_Initialize_Params();if(l.general.shortcode_id=e,l.general.unique_id="",l.general.files_count=wfu_filesselected(e),wfu_ProcessUploadComplete(e,0,l,"no-ajax","",a,"",["false","","false"]),1==s){var r="";document.getElementById("upfile_"+e).name="uploadedfile_"+e+"_redirected"+r}t>0?document.getElementById("adminerrorcodes_"+e).value=t:document.getElementById("adminerrorcodes_"+e).value="",document.getElementById("upfile_"+e).disabled=!1,document.getElementById("uniqueuploadid_"+e).value=wfu_randomString(10),document.getElementById("uploadform_"+e).submit()}},r="",i=new Date,o=GlobalData.consts.ajax_url+"?action=wfu_ajax_action&sid="+e+"&start_time="+i.getTime()+"&session_token="+a+r;wfu_lock_upload(e);var _=wfu_GetHttpRequestObject();if(null==_){var d=document.createElement("iframe");return d?(d.style.display="none",d.src=o,document.body.appendChild(d),void(d.onload=function(){l(d.contentDocument.body.innerHTML)})):void 0}_.open("GET",o,!0),_.onreadystatechange=function(){4==_.readyState&&200==_.status&&l(_.responseText)},_.send(null)}function wfu_filesselected(e){var a=document.getElementById("fileName_"+e),s=wfu_get_filelist(e);return 0==s.length&&a&&(a.value=GlobalData.consts.nofilemessage,a.className="file_input_textbox_nofile"),s.length}function wfu_check_required_userdata(e,a){for(var s=wfu_get_userdata_count(e),t=!1,n=0;s>n;n++){var l=document.getElementById("hiddeninput_"+e+"_userdata_"+n),r=document.getElementById("userdata_"+e+"_fieldwrapper_"+n),i=document.getElementById("userdata_"+e+"_field_"+n),o=document.getElementById("userdata_"+e+"_"+n),_=document.getElementById("userdata_"+e+"_hint_"+n);l.value=window["userdata_"+e+"_codes_"+n].value(i);
for(var d={hintposition:"none"},u=document.getElementById("userdata_"+e+"_props_"+n).value.split("|"),m=0;m<u.length;m++)"p:"==u[m].substr(0,2)&&(d.hintposition=u[m].substr(2));var c="";if("file_userdata_fieldwrapper_required"==r.className.substr(0,35)&&(c=window["userdata_"+e+"_codes_"+n].empty(l)),""===c&&window["userdata_"+e+"_codes_"+n].validate&&(c=window["userdata_"+e+"_codes_"+n].validate(l)),""!==c){if(a)if("none"==d.hintposition)_.className="file_userdata_hint_none";else{r.className="file_userdata_fieldwrapper_required_empty";var f=o.getBoundingClientRect(),p=r.getBoundingClientRect();"inline"==d.hintposition?(_.className="file_userdata_hint_inline",_.style.left=parseInt(p.left-f.left)+"px",_.style.top=parseInt(p.top-f.top)+"px",_.style.right=parseInt(f.right-p.right)+"px",_.style.bottom=parseInt(f.bottom-p.bottom)+"px"):"top"==d.hintposition?(_.className="file_userdata_hint_top",_.style.left=parseInt(p.left-f.left)+"px",_.style.bottom=parseInt(f.bottom-p.top)+"px"):"right"==d.hintposition?(_.className="file_userdata_hint_right",_.style.left=parseInt(p.right-f.left)+"px",_.style.top=parseInt(p.top-f.top)+"px"):"bottom"==d.hintposition?(_.className="file_userdata_hint_bottom",_.style.left=parseInt(p.left-f.left)+"px",_.style.top=parseInt(p.bottom-f.top)+"px"):"left"==d.hintposition&&(_.className="file_userdata_hint_left",_.style.right=parseInt(f.right-p.left)+"px",_.style.top=parseInt(p.top-f.top)+"px"),_.innerHTML=c,_.style.display="block"}t=!0}}return!t}function wfu_HTML5UploadFile(e,a,s){if(!wfu_BrowserCaps.supportsAJAX)return void wfu_redirect_to_classic(e,s,1,1);if(!wfu_BrowserCaps.supportsHTML5)return void wfu_redirect_to_classic(e,s,1,2);a=wfu_plugin_decode_string(a.replace(/^\s+|\s+$/g,""));var t=null;try{t=JSON.parse(a)}catch(n){}if(null==t)return void wfu_redirect_to_classic(e,s,1,3);var l=wfu_GetHttpRequestObject();if(null!=l){var r=wfu_filesselected(e);if(0!=r){var i=document.getElementById("upload_"+e),o=!i;if(!wfu_selectsubdir_check(e))return void(o&&wfu_clear_files(e));var _=r;return _+=_,wfu_check_required_userdata(e,!0)?void wfu_HTML5UploadFile_cont(e,t,s,[""]):void(o&&wfu_clear_files(e))}}}function wfu_HTML5UploadFile_cont(e,a,s,t){function n(t,r,i,o){p=!0;var c=wfu_GetHttpRequestObject(),g=wfu_GetHttpRequestObject();if(null!=c&&null!=g){var y=null,b=null;try{var y=new FormData,b=new FormData}catch(w){}if(null!=y&&null!=b){i||y.append("uploadedfile_"+e+d,r),y.append("uploadedfile_"+e+"_index",t),y.append("uploadedfile_"+e+"_name",wfu_plugin_encode_string(_[t].name)),y.append("uploadedfile_"+e+"_size",_[t].size),y.append("action","wfu_ajax_action"),y.append("uniqueuploadid_"+e,m),y.append("params_index",a.params_index),y.append("subdir_sel_index",l),i?y.append("only_check","1"):y.append("only_check","0"),y.append("session_token",s),y.append("unique_id",u);for(var h=wfu_get_userdata_count(e),v=0;h>v;v++)y.append("hiddeninput_"+e+"_userdata_"+v,document.getElementById("hiddeninput_"+e+"_userdata_"+v).value);var G=GlobalData[e].xhrs.push(c)-1,I=new Date;if(c.xhrid=G,c.shortcode_id=e,c.requesttype="fileupload",c.file_id=t+1,i?(c.size=0,c.totalsize=0,c.loading=!1):(c.size=r.size,c.totalsize=_[t].size,c.loading=!0),c.deltasize=0,c.sizeloaded=0,c.aborted=!1,c.unique_id=m,c.params_index=a.params_index,c.session_token=s,c.debugmode=a.debugmode,c.is_admin=a.is_admin,c.start_time=I.getTime(),c.end_time=c.start_time,c.finish_time=c.start_time+1e3*parseInt(GlobalData.consts.max_time_limit),c.fail_colors=a.fail_colors,c.error_message_header=a.error_header.replace(/%username%/g,"no data"),c.error_message_header=c.error_message_header.replace(/%useremail%/g,"no data"),c.error_message_header=c.error_message_header.replace(/%filename%/g,_[t].name),c.error_message_header=c.error_message_header.replace(/%filepath%/g,_[t].name),c.error_message_failed=GlobalData.consts.message_failed,c.error_message_cancelled=GlobalData.consts.message_cancelled,c.error_adminmessage_unknown=GlobalData.consts.adminmessage_unknown.replace(/%username%/g,"no data"),c.error_adminmessage_unknown=c.error_adminmessage_unknown.replace(/%useremail%/g,"no data"),c.error_adminmessage_unknown=c.error_adminmessage_unknown.replace(/%filename%/g,_[t].name),c.error_adminmessage_unknown=c.error_adminmessage_unknown.replace(/%filepath%/g,_[t].name),o){b.append("action","wfu_ajax_action"),b.append("params_index",a.params_index),b.append("session_token",s),b.append("force_connection_close","1"),g.open("POST",GlobalData.consts.ajax_url,!1);try{g.send(b)}catch(k){}p="success"==g.responseText}if(p)i?(c.addEventListener("load",function(a){a={target:{responseText:a.target.responseText,shortcode_id:e,return_status:!0}};var s=wfu_uploadComplete.call(c,a);p="success"==s||"warning"==s,p&&n(t,r,!1,!1)},!1),c.addEventListener("error",function(e){},!1),c.open("POST",GlobalData.consts.ajax_url,!0),c.send(y)):(c.upload.xhr=c,c.upload.dummy=1,c.upload.addEventListener("loadstart",wfu_loadStart,!1),c.upload.addEventListener("progress",new Function("evt","wfu_uploadProgress(evt, "+e+", "+G+", "+a.debugmode+");"),!1),c.addEventListener("load",wfu_uploadComplete,!1),c.addEventListener("error",new Function("evt","wfu_uploadFailed(evt, "+a.debugmode+");"),!1),c.addEventListener("abort",wfu_uploadCanceled,!1),c.open("POST",GlobalData.consts.ajax_url,!0),c.send(y));else{var B={target:{responseText:"",shortcode_id:e}};wfu_uploadComplete.call(c,B)}return f++,p}}}var l=-1,r=document.getElementById("selectsubdir_"+e);if(r){var i=document.getElementById("selectsubdiredit_"+e),o="none"!=i.style.display;l=o?i.value:r.selectedIndex}var _=wfu_get_filelist(e),d="",u=wfu_randomString(10),m=u;GlobalData.UploadInProgressString+="["+m+"]",GlobalData[e]={},GlobalData[e].unique_id=m,GlobalData[e].last=!1,GlobalData[e].files_count=1,GlobalData[e].files_processed=0,GlobalData[e].upload_state=0,GlobalData[e].message="",GlobalData[e].update_wpfilebase="",GlobalData[e].redirect_link="",GlobalData[e].notify_only_filename_list="",GlobalData[e].notify_target_path_list="",GlobalData[e].notify_attachment_list="",GlobalData[e].admin_messages={},GlobalData[e].admin_messages.wpfilebase="",GlobalData[e].admin_messages.notify="",GlobalData[e].admin_messages.redirect="",GlobalData[e].admin_messages.debug="",GlobalData[e].admin_messages.other="",GlobalData[e].errors={},GlobalData[e].errors.wpfilebase="",GlobalData[e].errors.notify="",GlobalData[e].errors.redirect="",GlobalData[e].xhrs=Array(),wfu_show_simple_progressbar(a.shortcode_id,"progressive");var c=wfu_Initialize_Params();c.general.shortcode_id=e,c.general.unique_id=m,wfu_ProcessUploadComplete(e,0,c,m,a.params_index,s,"",["false","","false"]);var f=0,p=!0,g=0;n(g,_[g],!0,!1)}function wfu_get_userdata_count(e){for(var a=0;document.getElementById("userdata_"+e+"_"+a);)a++;return a}function wfu_lock_upload(e){var a=document.getElementById("fileName_"+e);a&&(a.disabled=!0),document.getElementById("input_"+e).disabled=!0,document.getElementById("upfile_"+e).disabled=!0,wfu_selectsubdir_disable_onoff(e,!0);var s=document.getElementById("upload_"+e);s&&(s.disabled=!0);for(var t=wfu_get_userdata_count(e),n=0;t>n;n++)window["userdata_"+e+"_codes_"+n].lock(document.getElementById("userdata_"+e+"_field_"+n))}function wfu_unlock_upload(e){var a=document.getElementById("fileName_"+e);a&&(a.disabled=!1),document.getElementById("input_"+e).disabled=!1,document.getElementById("upfile_"+e).disabled=!1,wfu_selectsubdir_disable_onoff(e,!1);var s=document.getElementById("upload_"+e);s&&(s.disabled=!1);for(var t=wfu_get_userdata_count(e),n=0;t>n;n++)window["userdata_"+e+"_codes_"+n].unlock(document.getElementById("userdata_"+e+"_field_"+n))}function wfu_clear_files(e){document.getElementById("uploadform_"+e).reset();var a=document.getElementById("fileName_"+e);a&&(a.value="",a.className="file_input_textbox")}function wfu_clear(e){wfu_clear_files(e);var a=document.getElementById("selectsubdir_"+e);if(a){var s=document.getElementById("selectsubdiredit_"+e),t="none"!=s.style.display;t?(a.selectedIndex=-1,s.value=""):a.selectedIndex=parseInt(document.getElementById("selectsubdirdefault_"+e).value)}for(var n=wfu_get_userdata_count(e),l=0;n>l;l++)window["userdata_"+e+"_codes_"+l].reset(document.getElementById("userdata_"+e+"_field_"+l),document.getElementById("hiddeninput_"+e+"_userdata_"+l))}function wfu_reset_message(e){var a=document.getElementById("wfu_messageblock_"+e);if(a){document.getElementById("wfu_messageblock_header_"+e).style.display="";var s=document.getElementById("wfu_messageblock_header_"+e+"_container");UploadStates[e]&&(s.innerHTML=UploadStates[e].State0),document.getElementById("wfu_messageblock_header_"+e+"_state").value="none",document.getElementById("wfu_messageblock_arrow_"+e).style.display="none",s.colSpan=3,document.getElementById("wfu_messageblock_subheader_"+e+"_messagelabel").innerHTML="",document.getElementById("wfu_messageblock_subheader_"+e+"_adminmessagelabel").innerHTML="",document.getElementById("wfu_messageblock_subheader_"+e).style.display="none",document.getElementById("wfu_messageblock_subheader_"+e+"_message").style.display="none",document.getElementById("wfu_messageblock_subheader_"+e+"_adminmessage").style.display="none";for(var t=wfu_get_file_ids(e),n=1;n<=t.length;n++)a.tBodies[0].removeChild(document.getElementById("wfu_messageblock_"+e+"_"+n)),a.tBodies[0].removeChild(document.getElementById("wfu_messageblock_subheader_"+e+"_"+n))}}function wfu_show_simple_progressbar(e,a){var s=document.getElementById("progressbar_"+e+"_animation"),t=document.getElementById("progressbar_"+e+"_imagesafe");s&&("progressive"==a?(s.style.width="0%",s.className="file_progress_progressive",t.style.display="none",s.style.display="block"):wfu_BrowserCaps.supportsAnimation?(s.style.width="25%",s.className="file_progress_shuffle",t.style.display="none",s.style.display="block"):(s.style.width="0%",s.className="file_progress_noanimation",s.style.display="none",t.style.display="block"),document.getElementById("wordpress_file_upload_progressbar_"+e).style.display="block")}function wfu_hide_simple_progressbar(e){var a=document.getElementById("progressbar_"+e+"_animation"),s=document.getElementById("progressbar_"+e+"_imagesafe");a&&(document.getElementById("wordpress_file_upload_progressbar_"+e).style.display="none",a.style.width="0%",a.className="file_progress_noanimation",s.style.display="none",a.style.display="block")}function wfu_invoke_shortcode_editor(e,a,s,t){for(var n=document.getElementsByTagName("BUTTON"),l=0,r=null,i=0;i<n.length;i++)n[i].parentNode&&n[i].parentNode.id==t+"_editor_"+e&&(r=n[i],l++);if(0!=l){if(l>1)return void alert(GlobalData.consts.same_pluginid);var o=wfu_GetHttpRequestObject();if(null!=o){r.parentNode.style.display="none",document.getElementById(t+"_overlay_"+e).style.display="block";var _=GlobalData.consts.ajax_url;params=new Array(6),params[0]=new Array(2),params[0][0]="action",params[0][1]="wfu_ajax_action_edit_shortcode",params[1]=new Array(2),params[1][0]="upload_id",params[1][1]=e,params[2]=new Array(2),params[2][0]="post_id",params[2][1]=a,params[3]=new Array(2),params[3][0]="post_hash",params[3][1]=s,params[4]=new Array(2),params[4][0]="shortcode_tag",params[4][1]=t,params[5]=new Array(2),params[5][0]="widget_id",params[5][1]=document.getElementById(t+"_"+e+"_widgetid")?document.getElementById(t+"_"+e+"_widgetid").value:"";for(var d="",i=0;i<params.length;i++)d+=(i>0?"&":"")+params[i][0]+"="+encodeURI(params[i][1]);o.open("POST",_,!0),o.setRequestHeader("Content-type","application/x-www-form-urlencoded"),o.onreadystatechange=function(){if(4==o.readyState&&200==o.status){document.getElementById(t+"_overlay_"+e).style.display="none",r.parentNode.removeAttribute("style");var a="wfu_edit_shortcode:",s=o.responseText.indexOf(a);-1==s&&(s=o.responseText.length);var n=(o.responseText.substr(0,s),o.responseText.substr(s+a.length,o.responseText.length-s-a.length));s=n.indexOf(":");var l=n.substr(0,s);if(txt_value=n.substr(s+1,n.length-s-1),"success"==l){var i=window.open(wfu_plugin_decode_string(txt_value),"_blank");i?i.plugin_window=window:alert(GlobalData.consts.enable_popups)}else"check_page_obsolete"==l&&alert(txt_value)}},o.send(d)}}}GlobalData={},UploadStates={},GlobalData.filestatematch={},GlobalData.filestatematch.success=[0,1,2,2],GlobalData.filestatematch.warning=[1,1,2,2],GlobalData.filestatematch.error1=[3,3,2,3],GlobalData.filestatematch.error2=[2,2,2,3],GlobalData.UploadInProgressString="",GlobalData.FreeChangeHandler=!1,wfu_Check_Browser_Capabilities();